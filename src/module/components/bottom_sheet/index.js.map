{"version":3,"sources":["index.js"],"names":["React","Component","Animated","StyleSheet","View","Dimensions","Platform","PanGestureHandler","NativeViewGestureHandler","State","TapGestureHandler","get","width","height","BottomSheet","props","masterdrawer","createRef","drawer","drawerheader","scroll","scrollV","_onHeaderHandlerStateChange","nativeEvent","oldState","BEGAN","_lastScrollY","setValue","_onHandlerStateChange","snapTo","value","spring","_translateYOffset","tension","friction","toValue","useNativeDriver","nativeDriver","start","setState","lastSnap","ACTIVE","velocityY","translationY","_lastScrollYValue","dragToss","endOffsetY","state","destSnapPoint","snapPoints","i","length","snapPoint","distFromSnap","Math","abs","extractOffset","flattenOffset","_dragY","velocity","START","AFTER_START","END","bounces","Value","_onRegisterLastScroll","event","contentOffset","y","addListener","_onGestureEvent","_reverseLastScrollY","multiply","_translateY","add","interpolate","inputRange","outputRange","extrapolate","_radius","corderRadius","nextProps","OS","absoluteFillObject","transform","translateY","styles","container","animateBorder","overflow","borderTopLeftRadius","borderTopRightRadius","ref","scrollStyle","renderContent","defaultProps","BottomSheetContainer","bottomSheet","position","top","left","create","flex"],"mappings":"ifAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,QAAT,CAAmBC,UAAnB,CAA+BC,IAA/B,CAAqCC,UAArC,CAAiDC,QAAjD,KAAiE,cAAjE,CACA,OACEC,iBADF,CAEEC,wBAFF,CAGEC,KAHF,CAIEC,iBAJF,KAKO,8BALP,C,oBAO0BL,UAAU,CAACM,GAAX,CAAe,QAAf,C,CAAlBC,K,iBAAAA,K,CAAOC,M,iBAAAA,M,CAEf,UAAaC,CAAAA,WAAb,wDAUE,qBAAYC,KAAZ,CAAmB,6CACjB,6EAAMA,KAAN,GADiB,MATnBC,YASmB,CATJhB,KAAK,CAACiB,SAAN,EASI,OARnBC,MAQmB,CARVlB,KAAK,CAACiB,SAAN,EAQU,OAPnBE,YAOmB,CAPJnB,KAAK,CAACiB,SAAN,EAOI,OANnBG,MAMmB,CANVpB,KAAK,CAACiB,SAAN,EAMU,OALnBI,OAKmB,CALTrB,KAAK,CAACiB,SAAN,EAKS,OA4DnBK,2BA5DmB,CA4DW,cAAqB,IAAlBC,CAAAA,WAAkB,MAAlBA,WAAkB,CACjD,GAAIA,WAAW,CAACC,QAAZ,GAAyBf,KAAK,CAACgB,KAAnC,CAA0C,CACxC,MAAKC,YAAL,CAAkBC,QAAlB,CAA2B,CAA3B,EACD,CAED,MAAKC,qBAAL,CAA2B,CAAEL,WAAW,CAAXA,WAAF,CAA3B,EACD,CAlEkB,OA0EnBM,MA1EmB,CA0EV,SAACC,KAAD,CAAW,CAClB5B,QAAQ,CAAC6B,MAAT,CAAgB,MAAKC,iBAArB,CAAwC,CACtCC,OAAO,CAAE,EAD6B,CAEtCC,QAAQ,CAAE,EAF4B,CAGtCC,OAAO,CAAEL,KAH6B,CAItCM,eAAe,CAAE,MAAKrB,KAAL,CAAWsB,YAJU,CAAxC,EAKGC,KALH,CAKS,UAAM,CACb,MAAKC,QAAL,CAAc,CAAEC,QAAQ,CAAEV,KAAZ,CAAd,EACD,CAPD,EAQD,CAnFkB,OAqFnBF,qBArFmB,CAqFK,eAAqB,IAAlBL,CAAAA,WAAkB,OAAlBA,WAAkB,CAC3C,GAAIA,WAAW,CAACC,QAAZ,GAAyBf,KAAK,CAACgC,MAAnC,CAA2C,IACnCC,CAAAA,SADmC,CACPnB,WADO,CACnCmB,SADmC,CACxBC,YADwB,CACPpB,WADO,CACxBoB,YADwB,CAEzCA,YAAY,EAAI,MAAKC,iBAArB,CACA,GAAMC,CAAAA,QAAQ,CAAG,IAAjB,CACA,GAAMC,CAAAA,UAAU,CAAG,MAAKC,KAAL,CAAWP,QAAX,CAAsBG,YAAtB,CAAqCE,QAAQ,CAAGH,SAAnE,CAEA,GAAIM,CAAAA,aAAa,CAAG,MAAKjC,KAAL,CAAWkC,UAAX,CAAsB,CAAtB,CAApB,CAEA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,MAAKnC,KAAL,CAAWkC,UAAX,CAAsBE,MAA1C,CAAkDD,CAAC,EAAnD,CAAuD,CACrD,GAAME,CAAAA,SAAS,CAAG,MAAKrC,KAAL,CAAWkC,UAAX,CAAsBC,CAAtB,CAAlB,CACA,GAAMG,CAAAA,YAAY,CAAGC,IAAI,CAACC,GAAL,CAASH,SAAS,CAAGN,UAArB,CAArB,CACA,GAAIO,YAAY,CAAGC,IAAI,CAACC,GAAL,CAASP,aAAa,CAAGF,UAAzB,CAAnB,CAAyD,CACvDE,aAAa,CAAGI,SAAhB,CACD,CACF,CAED,MAAKb,QAAL,CAAc,CAAEC,QAAQ,CAAEQ,aAAZ,CAAd,EACA,MAAKhB,iBAAL,CAAuBwB,aAAvB,GACA,MAAKxB,iBAAL,CAAuBL,QAAvB,CAAgCgB,YAAhC,EACA,MAAKX,iBAAL,CAAuByB,aAAvB,GACA,MAAKC,MAAL,CAAY/B,QAAZ,CAAqB,CAArB,EAEAzB,QAAQ,CAAC6B,MAAT,CAAgB,MAAKC,iBAArB,CAAwC,CACtC2B,QAAQ,CAAEjB,SAD4B,CAEtCT,OAAO,CAAE,EAF6B,CAGtCC,QAAQ,CAAE,EAH4B,CAItCC,OAAO,CAAEa,aAJ6B,CAKtCZ,eAAe,CAAE,MAAKrB,KAAL,CAAWsB,YALU,CAAxC,EAMGC,KANH,GAOD,CACF,CApHkB,CAGjB,MAAKsB,KAAL,CAAa7C,KAAK,CAACkC,UAAN,CAAiB,CAAjB,CAAb,CACA,MAAKY,WAAL,CAAmB9C,KAAK,CAACkC,UAAN,CAAiB,CAAjB,CAAnB,CACA,MAAKa,GAAL,CAAY/C,KAAK,CAACkC,UAAN,CAAiBlC,KAAK,CAACkC,UAAN,CAAiBE,MAAjB,CAA0B,CAA3C,CAAZ,CAEA,MAAKJ,KAAL,CAAa,CACXP,QAAQ,CAAE,MAAKsB,GADJ,CAEXC,OAAO,CAAEhD,KAAK,CAACgD,OAFJ,CAAb,CAKA,MAAKnB,iBAAL,CAAyB,CAAzB,CACA,MAAKlB,YAAL,CAAoB,GAAIxB,CAAAA,QAAQ,CAAC8D,KAAb,CAAmB,CAAnB,CAApB,CACA,MAAKC,qBAAL,CAA6B/D,QAAQ,CAACgE,KAAT,CAC3B,CAAC,CAAE3C,WAAW,CAAE,CAAE4C,aAAa,CAAE,CAAEC,CAAC,CAAE,MAAK1C,YAAV,CAAjB,CAAf,CAAD,CAD2B,CAE3B,CAAEU,eAAe,CAAErB,KAAK,CAACsB,YAAzB,CAF2B,CAA7B,CAKA,MAAKX,YAAL,CAAkB2C,WAAlB,CAA8B,eAAe,IAAZvC,CAAAA,KAAY,OAAZA,KAAY,CAC3C,MAAKc,iBAAL,CAAyBd,KAAzB,CACA,GAAIA,KAAK,EAAI,EAAT,EAAef,KAAK,CAACgD,OAAzB,CAAkC,CAChC,MAAKxB,QAAL,CAAc,CAAEwB,OAAO,CAAE,KAAX,CAAd,EACD,CAFD,IAEO,CACL,MAAKxB,QAAL,CAAc,CAAEwB,OAAO,CAAE,IAAX,CAAd,EACD,CACF,CAPD,EASA,MAAKL,MAAL,CAAc,GAAIxD,CAAAA,QAAQ,CAAC8D,KAAb,CAAmB,CAAnB,CAAd,CAEA,MAAKM,eAAL,CAAuBpE,QAAQ,CAACgE,KAAT,CACrB,CAAC,CAAE3C,WAAW,CAAE,CAAEoB,YAAY,CAAE,MAAKe,MAArB,CAAf,CAAD,CADqB,CAErB,CAAEtB,eAAe,CAAErB,KAAK,CAACsB,YAAzB,CAFqB,CAAvB,CAKA,MAAKkC,mBAAL,CAA2BrE,QAAQ,CAACsE,QAAT,CACzB,GAAItE,CAAAA,QAAQ,CAAC8D,KAAb,CAAmB,CAAC,CAApB,CADyB,CAEzB,MAAKtC,YAFoB,CAA3B,CAKA,MAAKM,iBAAL,CAAyB,GAAI9B,CAAAA,QAAQ,CAAC8D,KAAb,CAAmB,MAAKF,GAAxB,CAAzB,CAEA,MAAKW,WAAL,CAAmBvE,QAAQ,CAACwE,GAAT,CACjB,MAAK1C,iBADY,CAEjB9B,QAAQ,CAACwE,GAAT,CAAa,MAAKhB,MAAlB,CAA0B,MAAKa,mBAA/B,CAFiB,EAGjBI,WAHiB,CAGL,CACZC,UAAU,CAAE,CAAC,MAAKhB,KAAN,CAAa,MAAKE,GAAlB,CADA,CAEZe,WAAW,CAAE,CAAC,MAAKjB,KAAN,CAAa,MAAKE,GAAlB,CAFD,CAGZgB,WAAW,CAAE,OAHD,CAHK,CAAnB,CASA,MAAKC,OAAL,CAAe7E,QAAQ,CAACwE,GAAT,CACb,MAAK1C,iBADQ,CAEb9B,QAAQ,CAACwE,GAAT,CAAa,MAAKhB,MAAlB,CAA0B,MAAKa,mBAA/B,CAFa,EAGbI,WAHa,CAGD,CACZC,UAAU,CAAE,CAAC,MAAKhB,KAAN,CAAa,MAAKC,WAAL,CAAmB,CAAhC,CADA,CAEZgB,WAAW,CAAE,CAAC,CAAD,CAAI9D,KAAK,CAACiE,YAAV,CAFD,CAGZF,WAAW,CAAE,OAHD,CAHC,CAAf,CAnDiB,aA2DlB,CArEH,4FA8EwBG,SA9ExB,CA8EmC,CAC/B,KAAKrB,KAAL,CAAaqB,SAAS,CAAChC,UAAV,CAAqB,CAArB,CAAb,CACA,KAAKY,WAAL,CAAmBoB,SAAS,CAAChC,UAAV,CAAqB,CAArB,CAAnB,CACA,KAAKa,GAAL,CAAYmB,SAAS,CAAChC,UAAV,CAAqBgC,SAAS,CAAChC,UAAV,CAAqBE,MAArB,CAA8B,CAAnD,CAAZ,CACD,CAlFH,uCAgIW,iBACP,MACE,qBAAC,iBAAD,EACE,aAAa,CAAE,MADjB,CAEE,GAAG,CAAE,KAAKnC,YAFZ,CAGE,SAAS,CAAE,KAAK+B,KAAL,CAAWP,QAAX,CAAsB,KAAKzB,KAAL,CAAWkC,UAAX,CAAsB,CAAtB,CAHnC,kDAIE,oBAAC,IAAD,EAAM,KAAK,CAAG3C,QAAQ,CAAC4E,EAAT,GAAgB,KAAhB,EAAyB/E,UAAU,CAACgF,kBAAlD,CAAsE,aAAa,CAAE,UAArF,kDACE,oBAAC,QAAD,CAAU,IAAV,EACE,KAAK,CACH,CACEvE,KAAK,CAALA,KADF,CAEEC,MAAM,CAANA,MAFF,CAGEuE,SAAS,CAAE,CAAC,CAAEC,UAAU,CAAE,KAAKZ,WAAnB,CAAD,CAHb,CAFJ,kDAQE,oBAAC,iBAAD,EACE,GAAG,CAAE,KAAKvD,MADZ,CAEE,oBAAoB,CAAE,CAAC,KAAKE,MAAN,CAAc,KAAKJ,YAAnB,CAFxB,CAGE,uBAAuB,CAAE,KAH3B,CAIE,cAAc,CAAE,KAAKsD,eAJvB,CAKE,oBAAoB,CAAE,KAAK1C,qBAL7B,kDAME,oBAAC,QAAD,CAAU,IAAV,EACE,KAAK,CAAE,CACL0D,MAAM,CAACC,SADF,CAEL,KAAKxE,KAAL,CAAWyE,aAAX,EAA4B,CAC1BC,QAAQ,CAAE,QADgB,CAE1BC,mBAAmB,CAAE,KAAKX,OAFA,CAG1BY,oBAAoB,CAAE,KAAKZ,OAHD,CAFvB,CADT,kDAUE,oBAAC,wBAAD,EACE,GAAG,CAAE,KAAK3D,MADZ,CAEE,OAAO,CAAE,KAAKJ,YAFhB,CAGE,oBAAoB,CAAE,KAAKE,MAH7B,kDAIE,oBAAC,QAAD,CAAU,UAAV,EACE,GAAG,CAAE,aAAA0E,KAAG,CAAI,CAAE,MAAI,CAACvE,OAAL,CAAeuE,KAAf,CAAmB,CADnC,CAEE,KAAK,CAAE,KAAK7E,KAAL,CAAW8E,WAFpB,CAGE,OAAO,CAAE,KAAK9C,KAAL,CAAWgB,OAHtB,CAIE,iBAAiB,CAAE,KAAKE,qBAJ1B,CAKE,mBAAmB,CAAE,EALvB,kDAMK,KAAKlD,KAAL,CAAW+E,aAAX,EANL,CAJF,CAVF,CANF,CARF,CADF,CAJF,CADF,CAiDD,CAlLH,yBAAiC7F,SAAjC,EAqLAa,WAAW,CAACiF,YAAZ,CAA2B,CACzBhC,OAAO,CAAE,IADgB,CAEzB1B,YAAY,CAAE,IAFW,CAGzBmD,aAAa,CAAE,KAHU,CAIzBR,YAAY,CAAE,EAJW,CAA3B,C,GAOqBgB,CAAAA,oB,+aACnBC,W,CAAcjG,KAAK,CAACiB,SAAN,E,QAEdY,M,CAAS,SAACC,KAAD,CAAW,CAClB,OAAKmE,WAAL,CAAiBpE,MAAjB,CAAwBC,KAAxB,EACD,C,wFAEQ,iBACP,MACE,qBAAC,IAAD,EAAM,KAAK,CAAE,CAACwD,MAAM,CAACC,SAAR,CAAmB,CAAEW,QAAQ,CAAE,UAAZ,CAAwBC,GAAG,CAAE,CAA7B,CAAgCC,IAAI,CAAE,CAAtC,CAAnB,CAAb,kDACE,oBAAC,WAAD,WAAa,GAAG,CAAE,aAAAR,KAAG,CAAI,CAAE,MAAI,CAACK,WAAL,CAAmBL,KAAnB,CAAwB,CAAnD,EAAyD,KAAK7E,KAA9D,oDADF,CADF,CAKD,C,kCAb+Cd,S,SAA7B+F,oB,aAkBrB,GAAMV,CAAAA,MAAM,CAAGnF,UAAU,CAACkG,MAAX,CAAkB,CAC/Bd,SAAS,CAAE,CACTe,IAAI,CAAE,CADG,CADoB,CAAlB,CAAf","sourcesContent":["import React, { Component } from 'react'\nimport { Animated, StyleSheet, View, Dimensions, Platform } from 'react-native'\nimport {\n  PanGestureHandler,\n  NativeViewGestureHandler,\n  State,\n  TapGestureHandler,\n} from 'react-native-gesture-handler'\n\nconst { width, height } = Dimensions.get('window')\n\nexport class BottomSheet extends Component {\n  masterdrawer = React.createRef()\n  drawer = React.createRef()\n  drawerheader = React.createRef()\n  scroll = React.createRef()\n  scrollV = React.createRef()\n  START\n  AFTER_START\n  END\n\n  constructor(props) {\n    super(props)\n\n    this.START = props.snapPoints[0]\n    this.AFTER_START = props.snapPoints[1]\n    this.END =  props.snapPoints[props.snapPoints.length - 1]\n\n    this.state = {\n      lastSnap: this.END,\n      bounces: props.bounces\n    }\n\n    this._lastScrollYValue = 0\n    this._lastScrollY = new Animated.Value(0)\n    this._onRegisterLastScroll = Animated.event(\n      [{ nativeEvent: { contentOffset: { y: this._lastScrollY } } }],\n      { useNativeDriver: props.nativeDriver }\n    )\n\n    this._lastScrollY.addListener(({ value }) => {\n      this._lastScrollYValue = value\n      if (value <= 20 && props.bounces) {\n        this.setState({ bounces: false })\n      } else {  \n        this.setState({ bounces: true })\n      }\n    })\n\n    this._dragY = new Animated.Value(0)\n\n    this._onGestureEvent = Animated.event(\n      [{ nativeEvent: { translationY: this._dragY } }],\n      { useNativeDriver: props.nativeDriver }\n    )\n\n    this._reverseLastScrollY = Animated.multiply(\n      new Animated.Value(-1),\n      this._lastScrollY\n    )\n\n    this._translateYOffset = new Animated.Value(this.END)\n\n    this._translateY = Animated.add(\n      this._translateYOffset,\n      Animated.add(this._dragY, this._reverseLastScrollY)\n    ).interpolate({\n      inputRange: [this.START, this.END],\n      outputRange: [this.START, this.END],\n      extrapolate: 'clamp',\n    })\n\n    this._radius = Animated.add(\n      this._translateYOffset,\n      Animated.add(this._dragY, this._reverseLastScrollY)\n    ).interpolate({\n      inputRange: [this.START, this.AFTER_START / 2],\n      outputRange: [0, props.corderRadius],\n      extrapolate: 'clamp',\n    })\n  }\n  _onHeaderHandlerStateChange = ({ nativeEvent }) => {\n    if (nativeEvent.oldState === State.BEGAN) {\n      this._lastScrollY.setValue(0)\n    }\n\n    this._onHandlerStateChange({ nativeEvent })\n  }\n\n  shouldComponentUpdate(nextProps) {\n    this.START = nextProps.snapPoints[0]\n    this.AFTER_START = nextProps.snapPoints[1]\n    this.END =  nextProps.snapPoints[nextProps.snapPoints.length - 1]\n  }\n\n  snapTo = (value) => {\n    Animated.spring(this._translateYOffset, {\n      tension: 68,\n      friction: 12,\n      toValue: value,\n      useNativeDriver: this.props.nativeDriver,\n    }).start(() => {\n      this.setState({ lastSnap: value })\n    })\n  }\n\n  _onHandlerStateChange = ({ nativeEvent }) => {\n    if (nativeEvent.oldState === State.ACTIVE) {\n      let { velocityY, translationY } = nativeEvent\n      translationY -= this._lastScrollYValue\n      const dragToss = 0.05\n      const endOffsetY = this.state.lastSnap + translationY + dragToss * velocityY\n\n      let destSnapPoint = this.props.snapPoints[0]\n\n      for (let i = 0; i < this.props.snapPoints.length; i++) {\n        const snapPoint = this.props.snapPoints[i]\n        const distFromSnap = Math.abs(snapPoint - endOffsetY)\n        if (distFromSnap < Math.abs(destSnapPoint - endOffsetY)) {\n          destSnapPoint = snapPoint\n        }\n      }\n\n      this.setState({ lastSnap: destSnapPoint })\n      this._translateYOffset.extractOffset()\n      this._translateYOffset.setValue(translationY)\n      this._translateYOffset.flattenOffset()\n      this._dragY.setValue(0)\n\n      Animated.spring(this._translateYOffset, {\n        velocity: velocityY,\n        tension: 68,\n        friction: 12,\n        toValue: destSnapPoint,\n        useNativeDriver: this.props.nativeDriver,\n      }).start()\n    }\n  }\n\n  render() {\n    return (\n      <TapGestureHandler\n        maxDurationMs={100000}\n        ref={this.masterdrawer}\n        maxDeltaY={this.state.lastSnap - this.props.snapPoints[0]}>\n        <View style={ Platform.OS === 'ios' && StyleSheet.absoluteFillObject} pointerEvents={\"box-none\"}>\n          <Animated.View\n            style={\n              {\n                width,\n                height,\n                transform: [{ translateY: this._translateY }],\n              }\n            }>\n            <PanGestureHandler\n              ref={this.drawer}\n              simultaneousHandlers={[this.scroll, this.masterdrawer]}\n              shouldCancelWhenOutside={false}\n              onGestureEvent={this._onGestureEvent}\n              onHandlerStateChange={this._onHandlerStateChange}>\n              <Animated.View \n                style={[\n                  styles.container,\n                  this.props.animateBorder && {\n                    overflow: 'hidden',\n                    borderTopLeftRadius: this._radius,\n                    borderTopRightRadius: this._radius\n                  }\n                ]}\n              >\n                <NativeViewGestureHandler\n                  ref={this.scroll}\n                  waitFor={this.masterdrawer}\n                  simultaneousHandlers={this.drawer}>\n                  <Animated.ScrollView\n                    ref={ref => { this.scrollV = ref}}\n                    style={this.props.scrollStyle}\n                    bounces={this.state.bounces}\n                    onScrollBeginDrag={this._onRegisterLastScroll}\n                    scrollEventThrottle={16}>\n                      {this.props.renderContent()}\n                  </Animated.ScrollView>\n                </NativeViewGestureHandler>\n              </Animated.View>\n            </PanGestureHandler>\n          </Animated.View>\n        </View>\n      </TapGestureHandler>\n    )\n  }\n}\n\nBottomSheet.defaultProps = {\n  bounces: true,\n  nativeDriver: true,\n  animateBorder: false,\n  corderRadius: 20\n}\n\nexport default class BottomSheetContainer extends Component {\n  bottomSheet = React.createRef()\n\n  snapTo = (value) => {\n    this.bottomSheet.snapTo(value)\n  }\n\n  render() {\n    return (\n      <View style={[styles.container, { position: 'absolute', top: 0, left: 0 }]}>\n        <BottomSheet ref={ref => { this.bottomSheet = ref }} {...this.props} />\n      </View>\n    )\n  }\n}\n\n\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  }\n})"]}