{"version":3,"sources":["pop_up.next.js"],"names":["Dimensions","get","width","height","EPSILON","easeIn","Easing","bezier","easeOut","easeInOut","def","PopUp","props","masterdrawer","React","createRef","drawer","drawerheader","scroll","scrollV","_onHeaderHandlerStateChange","nativeEvent","oldState","State","BEGAN","_lastScrollY","setValue","_onHandlerStateChange","snapTo","value","Animated","timing","_translateYOffset","duration","toValue","easing","useNativeDriver","nativeDriver","start","setState","lastSnap","ACTIVE","velocityY","translationY","_lastScrollYValue","dragToss","endOffsetY","state","destSnapPoint","snapPoints","i","length","snapPoint","distFromSnap","Math","abs","extractOffset","flattenOffset","_dragY","spring","velocity","tension","friction","dismiss","START","AFTER_START","END","bounces","_onRegisterLastScroll","event","contentOffset","y","addListener","_onGestureEvent","_reverseLastScrollY","multiply","Value","_translateY","add","interpolate","inputRange","outputRange","extrapolate","_radius","cornerRadius","position","top","left","right","bottom","transform","translateY","styles","container","animateBorder","overflow","borderTopLeftRadius","borderTopRightRadius","ref","scrollStyle","minWidth","minHeight","renderContent","Component","defaultProps","StyleSheet","create","flex","header","backgroundColor"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Animated, StyleSheet, View, Dimensions, Easing } from 'react-native'\nimport {\n  PanGestureHandler,\n  NativeViewGestureHandler,\n  State,\n  TapGestureHandler,\n} from 'react-native-gesture-handler'\n\nconst { width, height } = Dimensions.get('window')\n\nconst EPSILON = 1e-9\n\nconst easeIn = Easing.bezier(0.42, 0, 1, 1, EPSILON)\nconst easeOut = Easing.bezier(0, 0, 0.58, 1, EPSILON)\nconst easeInOut = Easing.bezier(0.42, 0, 0.58, 1, EPSILON)\nconst def = Easing.bezier(0.25, 0.1, 0.25, 1, EPSILON)\n\nexport default class PopUp extends Component {\n  masterdrawer = React.createRef()\n  drawer = React.createRef()\n  drawerheader = React.createRef()\n  scroll = React.createRef()\n  scrollV = React.createRef()\n\n  constructor(props) {\n    super(props)\n    const START = props.snapPoints[0]\n    const AFTER_START = props.snapPoints[1]\n    const END = props.snapPoints[props.snapPoints.length - 1]\n\n    this.state = {\n      lastSnap: END,\n      bounces: props.bounces\n    }\n\n    this._lastScrollYValue = props._lastScrollYValue\n    this._lastScrollY = props._lastScrollY\n\n    this._onRegisterLastScroll = Animated.event(\n      [{ nativeEvent: { contentOffset: { y: this._lastScrollY } } }],\n      { useNativeDriver: props.nativeDriver }\n    )\n\n    this._lastScrollY.addListener(({ value }) => {\n      this._lastScrollYValue = value\n      if (value <= 20) {\n        this.setState({ bounces: false })\n      } else {  \n        this.setState({ bounces: true })\n      }\n    })\n\n    this._dragY = props._dragY\n\n    this._onGestureEvent = Animated.event(\n      [{ nativeEvent: { translationY: this._dragY } }],\n      { useNativeDriver: props.nativeDriver }\n    )\n\n    this._reverseLastScrollY = Animated.multiply(\n      new Animated.Value(-1),\n      this._lastScrollY\n    )\n\n    this._translateYOffset = props._translateYOffset\n\n    this._translateY = Animated.add(\n      this._translateYOffset,\n      Animated.add(this._dragY, this._reverseLastScrollY)\n    ).interpolate({\n      inputRange: [START, END],\n      outputRange: [START, END],\n      extrapolate: 'clamp',\n    })\n\n    this._radius = Animated.add(\n      this._translateYOffset,\n      Animated.add(this._dragY, this._reverseLastScrollY)\n    ).interpolate({\n      inputRange: [START, AFTER_START / 12],\n      outputRange: [0, props.cornerRadius],\n      extrapolate: 'clamp',\n    })\n  }\n\n  componentDidMount() {\n    // this.snapTo(this.props.snapPoints[0])\n  }\n\n  _onHeaderHandlerStateChange = ({ nativeEvent }) => {\n    if (nativeEvent.oldState === State.BEGAN) {\n      this._lastScrollY.setValue(0)\n    }\n\n    this._onHandlerStateChange({ nativeEvent })\n  }\n\n  snapTo = (value) => {\n    Animated.timing(this._translateYOffset, {\n      // velocity: 0,\n      // overshootClamping: true,\n      // tension: 68,\n      // friction: 12,\n      duration: 250,\n      toValue: value,\n      easing: def,\n      useNativeDriver: this.props.nativeDriver,\n    }).start(() => {\n      this.setState({ lastSnap: value })\n    })\n  }\n\n  _onHandlerStateChange = ({ nativeEvent }) => {\n    if (nativeEvent.oldState === State.ACTIVE) {\n      let { velocityY, translationY } = nativeEvent\n      translationY -= this._lastScrollYValue\n      const dragToss = 0.05\n      const endOffsetY = this.state.lastSnap + translationY + dragToss * velocityY\n\n      let destSnapPoint = this.props.snapPoints[0]\n\n      for (let i = 0; i < this.props.snapPoints.length; i++) {\n        const snapPoint = this.props.snapPoints[i]\n        const distFromSnap = Math.abs(snapPoint - endOffsetY)\n        if (distFromSnap < Math.abs(destSnapPoint - endOffsetY)) {\n          destSnapPoint = snapPoint\n        }\n      }\n\n      this.setState({ lastSnap: destSnapPoint })\n      this._translateYOffset.extractOffset()\n      this._translateYOffset.setValue(translationY)\n      this._translateYOffset.flattenOffset()\n      this._dragY.setValue(0)\n\n      Animated.spring(this._translateYOffset, {\n        velocity: velocityY,\n        tension: 68,\n        friction: 12,\n        toValue: destSnapPoint,\n        useNativeDriver: this.props.nativeDriver,\n      }).start(() => {\n        if (this.state.lastSnap === this.props.snapPoints[this.props.snapPoints.length - 1]) {\n          this.props.dismiss()\n        }\n      })\n    }\n  }\n\n  render() {\n    return (\n      <TapGestureHandler\n        maxDurationMs={100000}\n        ref={this.masterdrawer}\n        maxDeltaY={this.state.lastSnap - this.props.snapPoints[0]}>\n        <View style={{ position: 'absolute', width, height, top: 0, left: 0, right: 0, bottom: 0 }} pointerEvents=\"box-none\">\n          <Animated.View\n            style={\n              {\n                width,\n                height,\n                transform: [{ translateY: this._translateY }],\n              }\n            }>\n            <PanGestureHandler\n              ref={this.drawer}\n              simultaneousHandlers={[this.scroll, this.masterdrawer]}\n              shouldCancelWhenOutside={false}\n              onGestureEvent={this._onGestureEvent}\n              onHandlerStateChange={this._onHandlerStateChange}>\n              <Animated.View \n                style={[\n                  styles.container,\n                  this.props.animateBorder && {\n                    overflow: 'hidden',\n                    borderTopLeftRadius: this._radius,\n                    borderTopRightRadius: this._radius\n                  },\n                  !this.props.animateBorder && {\n                    overflow: 'hidden',\n                    borderTopLeftRadius: this.props.cornerRadius,\n                    borderTopRightRadius: this.props.cornerRadius\n                  }\n                ]}\n              >\n                <NativeViewGestureHandler\n                  ref={this.scroll}\n                  waitFor={this.masterdrawer}\n                  simultaneousHandlers={this.drawer}>\n                  <Animated.ScrollView\n                    ref={ref => { this.scrollV = ref}}\n                    style={this.props.scrollStyle}\n                    bounces={this.state.bounces}\n                    contentContainerStyle={{ minWidth: width, minHeight: height }}\n                    onScrollBeginDrag={this._onRegisterLastScroll}\n                    scrollEventThrottle={16}>\n                      {this.props.renderContent()}\n                  </Animated.ScrollView>\n                </NativeViewGestureHandler>\n              </Animated.View>\n            </PanGestureHandler>\n          </Animated.View>\n        </View>\n      </TapGestureHandler>\n    )\n  }\n}\n\nPopUp.defaultProps = {\n  bounces: true,\n  nativeDriver: true,\n  animateBorder: false,\n  cornerRadius: 20\n}\n\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    backgroundColor: 'red',\n  },\n})"]}